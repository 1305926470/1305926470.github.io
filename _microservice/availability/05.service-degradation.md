









优雅降级



优雅降级不应该经常被触发一一降级通常说明容量规划的失误, 或者是出现了意料之外的负载转移。

整个降级系统应该简单、易懂, 尤其是在不经常使用的情况下。







复杂的流量抛弃和优雅降级系统本身就可能造成问題。

设计时应该实现一种简单的关闭降级模式, 或者是快速调节参数的方式。

将这个配置文件存储在一个强一致性的存储系统(如 Chubby)中, 每个软件服务器都可以订阅改变, 可以提高部署速度, 但是同时也会增加整个系统的同步性风险(如果配置文件有问题, 全部服务器同时都会受到影响)。











我们还应该测试一个组件在过载之后再恢复到正常水平的行为状态。这种测试可能可以帮助回答下列问题

- 如果一个组件在高负载条件下进入了降级模式,它是否能够在无人工干顶的情况下退出该模式? 
- 如果高负载情况下几个服务器崩溃,负载需要降低多少才能使系统重新稳定下来?













### 进入降级模式

1.消除批处理负载

某些服务有一些重要的, 但是并非关键的流量负载, 可考虑将这些负载来源关闭。例如, 搜索索引的更新、数据复制、请求处理过程中的资源统计等,可考虑关闭这些来降低负载。

2.消除有害的流量

如果某些请求造成了高负载,或者是崩溃(如致死请求),可考虑将它们屏蔽掉,或者是通过其他手段消除。