# 文件传输协议

[TOC]



## FTP

文件传输协议（File Transfer Protocol，FTP）是一个用于通过网络上在客户端和服务器之间进行文件传输的应用层协议。

可靠和高效的传输数据

FTP是一个8位的客户端-服务器协议，能操作任何类型的文件而不需要进一步处理，就像MIME或Unicode一样。

FTP 有着极高的延时。





FTP服务一般运行在20和21两个端口。

- 端口 20 用于在客户端和服务器之间传`输数据流`
- 端口 21 用于传输`控制流`，并且是命令通向 ftp 服务器的进口。

当数据通过数据流传输时，控制流处于空闲状态。

当控制流空闲很长时间后，客户端的防火墙会将其会话置为超时，这样当大量数据通过防火墙时，会产生一些问题。此时，虽然文件可以成功的传输，但因为控制会话，会被防火墙断开；传输会产生一些错误。





运行FTP服务的许多站点都开放匿名服务，在这种设置下，用户不需要帐号就可以登录服务器，默认情况下，匿名用户的用户名是：“anonymous”。这个帐号不需要密码，虽然通常要求输入用户的邮件地址作为认证密码，但这只是一些细节或者此邮件地址根本不被确定，而是依赖于FTP服务器的配置情况。



### 主动和被动模式

FTP有两种使用模式：主动和被动。

主动模式要求客户端和服务器端同时打开并且监听一个端口以创建连接。在这种情况下，客户端由于安装了防火墙会产生一些问题。所以，创立了被动模式。

被动模式只要求服务器端产生一个监听相应端口的进程，这样就可以绕过客户端安装了防火墙的问题。



### 语法

FTP URL 格式为：`ftp://[user[:password]@]host[:port]/url-path`（方括号内为可选参数）。

默认情况下，大多数Web浏览器使用被动（PASV）模式，该模式更容易遍历终端防火墙。

### 安全性

FTP不是一项安全的协议，并且具有许多安全漏洞

暴力破解
FTP反弹攻击
数据包捕获
端口窃取（猜测下一个开放端口并篡夺合法连接）
欺骗攻击
用户名枚举

通过 FTP 传输的流量不会被加密，所有传输通过明文进行的。任何能够在网络上执行数据包捕获（嗅探）的人都可以读取用户名、密码、命令内容和数据。

此问题的常见解决方案包括：

- 使用协议的安全版本，例如FTPS而不是FTP，TelnetS而不是Telnet。
- 使用可以处理作业的不同的，更安全的协议，例如 SSH文件传输协议或安全复制协议 。
- 使用安全隧道（如Secure Shell或虚拟专用网 ）。

Chrome 和 Firefox 等主流浏览器都放弃对FTP的支持，目前Chrome 82已移除对FTP的支持，而Firefox 则于版本77中停止支持FTP。



## FTPS 

FTPS是一种对常用的文件传输协议（FTP）添加传输层安全（TLS）和安全套接层（SSL）加密协议支持的扩展协议。

FTPS 不要与SSH文件传输协议或是Secure FTP协议相混淆。

FTP 最初只有一小部分军事用地和大学里的少数人使用，可以使用网络的人，任何人都可以操作访问，无视于用户的数据安全和隐私要求。



## SFTP

SSH文件传输协议（**Secret File Transfer Protocol** 缩写：SFTP）可用于传输文件并具有类似的用户命令集，但使用Secure Shell协议（SSH）传输文件。与FTP不同，它对命令和数据进行加密，防止密码和敏感信息通过网络公开传输。它无法与FTP兼容。



## SCP 安全复制

安全复制（Secure copy，缩写SCP）是指在本地主机与远程主机或者两台远程主机之间基于 Secure Shell（SSH）协议安全地传输电脑文件。“SCP”通常指安全复制协议或者程序本身。



**SFTP 与 SCP**

 sftp 是一种功能更强大的文件传输协议，也基于SSH。 更像是远程文件管理协议，**sftp**允许对远程文件（查看目录，删除文件和目录等）进行一系列操作。

- 安全性——二者都是基于 SSH协议，它们都提供相同的安全功能，包括密码和数据加密以及公钥验证。

- 速度——在传输文件时，**scp**通常比**sftp**快得多，尤其是在网络延迟很高的情况下。这是因为**scp**实现了更高效的传输算法，不需要等待数据包确认。
- 功能/可用性—— **scp** 提供的功能不同于其名称所暗示的那样：安全地复制文件（Secure copy）。如果您或您的用户将管理文件（包括查看/搜索目录，创建文件夹和组织文件，删除或重命名文件等），**sftp**是优秀的协议。此外，**sftp**还支持断点续传，这在网络连接不佳的环境中将大有帮助。 所以功能上 **sftp** 等强大。
- 传输文件大小—— **scp**和**sftp** 都没有文件大小限制。



## 小型文件传输协议

Trivial File Transfer Protocol, TFTP

## 简单文件传输协议

简单文件传输协议（Simple File Transfer Protocol）